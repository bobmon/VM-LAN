<html><head>
<style type="text/css">
@import url("/css/generic.css");
pre {font-size:10pt;}
.fancyfont {color:#00a;}
</style>
</head><body>
<pre>
<span class="Remark fancyfont">#-----------------------------------------------------------</span>
<span class="Remark fancyfont"># Set firewall on border router.</span>
<span class="Remark fancyfont"># Block outbound packets that don't claim to be from a LAN.</span>
<span class="Remark fancyfont"># 2016-10-22</span>
<span class="Remark fancyfont">#-----------------------------------------------------------</span>

<span class="Remark fancyfont"># Block packets with invalid source addresses:</span>
set firewall name 'Hosts-to-World' default-action 'drop'
 
<span class="Remark fancyfont"># Accept packets from the routers?:</span>
<span class="Remark fancyfont">#set firewall name 'Hosts-to-World' rule 10 action 'accept'</span>
<span class="Remark fancyfont">#set firewall name 'Hosts-to-World' rule 10 source address 10.141.0.0/16</span>
<span class="Remark fancyfont"># </span>
<span class="Remark fancyfont"># Accept packets from LAN hosts:</span>
set firewall name 'Hosts-to-World' rule 20 action 'accept'
set firewall name 'Hosts-to-World' rule 20 source address 172.16.0.0/16

<span class="Remark fancyfont"># bind firewall rulesets to an interface</span>
set interfaces ethernet eth0 firewall out name 'Hosts-to-World'
<span class="Remark fancyfont">#-----------------------------------------------------------</span>
</pre></body></html>
